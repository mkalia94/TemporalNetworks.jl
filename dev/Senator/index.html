<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Real world example: network of US senators · TemporalNetworks</title><meta name="title" content="Real world example: network of US senators · TemporalNetworks"/><meta property="og:title" content="Real world example: network of US senators · TemporalNetworks"/><meta property="twitter:title" content="Real world example: network of US senators · TemporalNetworks"/><meta name="description" content="Documentation for TemporalNetworks."/><meta property="og:description" content="Documentation for TemporalNetworks."/><meta property="twitter:description" content="Documentation for TemporalNetworks."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TemporalNetworks</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">TemporalNetworks.jl</a></li><li><a class="tocitem" href="../GettingStarted/">Getting Started</a></li><li><a class="tocitem" href="../NonMultiplex/">Nonmultiplex temporal networks</a></li><li class="is-active"><a class="tocitem" href>Real world example: network of US senators</a><ul class="internal"><li><a class="tocitem" href="#The-Senator-network"><span>The Senator network</span></a></li><li><a class="tocitem" href="#State-network"><span>State network</span></a></li><li><a class="tocitem" href="#Comparing-results-from-the-senator-and-state-network"><span>Comparing results from the senator and state network</span></a></li></ul></li><li><a class="tocitem" href="../conts/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Real world example: network of US senators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Real world example: network of US senators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mkalia94/TemporalNetworks.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mkalia94/TemporalNetworks.jl/blob/main/docs/src/Senator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Real-world-example:-network-of-US-senators"><a class="docs-heading-anchor" href="#Real-world-example:-network-of-US-senators">Real world example: network of US senators</a><a id="Real-world-example:-network-of-US-senators-1"></a><a class="docs-heading-anchor-permalink" href="#Real-world-example:-network-of-US-senators" title="Permalink"></a></h1><p>This elaborated example can be found as a <code>Pluto</code> notebook in the <code>PaperExamples</code> branch under <code>senator/senator_nb.jl</code>.</p><p>In <a href="https://arxiv.org/abs/0907.3509">WPF+09</a> and <a href="https://arxiv.org/abs/0911.1824">MRM+10</a> a network of senators was analyzed to understand party polarisation across time in the US Senate. We analyse the same network here in detail to discover communities that vary in time. The network data was collected from <a href="https://www.voteview.com">here</a>.</p><p>The network describes voting patterns between US senators/states. Each vertex corresponds to either a single senator or state, and the edge weight between any two vertices describes the voting similarity between the vertices, and lies in <span>$[0,1]$</span>. More details can be found in <a href="https://arxiv.org/abs/0907.3509">WPF+09</a>.</p><p>Here we analyse the networks from the 100-100th congress, or the years 1987-2009.</p><p>From the CSV files obtained, one can generate adjacency matrices using the files provided in the <code>PaperExamples</code> branch under <code>senator/raw_data/build_dataset.jl</code>.</p><p>We start by loading important packages,</p><pre><code class="language-julia hljs">using TemporalNetworks, Plots, FileIO, JLD2</code></pre><p>The file <code>senator/raw_data/build_dataset.jl</code> generates two collections of adjacency matrices, one each corresponding to the network of US senators and a network of US states. We load them, their labels (party affiliations/state names) and construct the <code>MultilayerGraph</code> and <code>SpectralPartition</code> instances. Note that the network of senators is nonmultiplex, while the state network is multiplex.</p><pre><code class="language-julia hljs">W = FileIO.load(&quot;senator.jld2&quot;,&quot;W&quot;)
labels_party = FileIO.load(&quot;senator.jld2&quot;,&quot;labels_party&quot;)
labels_state = FileIO.load(&quot;senator.jld2&quot;,&quot;labels_state&quot;)

mlgraph= MultilayerGraph(W, connect = NonMultiplexCompressed())
partition = SpectralPartition(mlgraph, compute_a = RayleighBalancing(2))

W_state = FileIO.load(&quot;state.jld2&quot;, &quot;W&quot;);
lab_statelist = FileIO.load(&quot;state.jld2&quot;, &quot;labels&quot;);
mlgraph_state = MultilayerGraph(W_state);
partition_state = SpectralPartition(mlgraph_state)</code></pre><h2 id="The-Senator-network"><a class="docs-heading-anchor" href="#The-Senator-network">The Senator network</a><a id="The-Senator-network-1"></a><a class="docs-heading-anchor-permalink" href="#The-Senator-network" title="Permalink"></a></h2><p>We plot eigenvectors of the inflated dynamic Laplacian with respect to the senator network to select vectors which will induce the desired spacetime partition. </p><pre><code class="language-julia hljs">h = plot(partition); plot(h[1][1:4]...)</code></pre><p><img src="../figs/evecs_senator.svg" alt/></p><p>Clearly eigenvector 3 is the first &quot;spatial&quot; eigenvector, which we use to construct the spacetime Laplacian. First, we carefully reorder vertices according to their temporal mean values, for visual convenience.</p><pre><code class="language-julia hljs">evec_crit = reshape(partition.evecs[:,3],mlgraph.N, mlgraph.T)
sens = find_active(mlgraph)

lengths = zeros(mlgraph.N)
for i in 1:mlgraph.N
    ctr = 0
    for x in sens
        ind = findall(y-&gt;y==i,x)
        ctr += length(ind)
    end
    lengths[i] = ctr
end

aa = sum(hcat([evec_crit[:,i] for i in 1:mlgraph.T]...), dims=2) ./ lengths
v = sortperm(aa, dims=1)[:,1]
ordering = vcat([v .+ (i-1)*mlgraph.N for i in 1:mlgraph.T]...)</code></pre><p>We now use <code>v</code> and ordering from the previous cell to reorder eigenvectors, labels and the network adjacencies appropriately.</p><pre><code class="language-julia hljs">partition.evecs = partition.evecs[ordering, :]
lab_party = labels_party[v]
lab_state = labels_state[v]
mlgraph.W = [x[v,v] for x in mlgraph.W]</code></pre><p>We do a small preprocessing step for the party affiliations.</p><pre><code class="language-julia hljs">for i in 1:mlgraph.N
    if lab_party[i] == 328
        lab_party[i] = 0
    elseif lab_party[i] == 100
        lab_party[i] = 1
    elseif lab_party[i] == 200
        lab_party[i] = -1
    end
end</code></pre><h2 id="State-network"><a class="docs-heading-anchor" href="#State-network">State network</a><a id="State-network-1"></a><a class="docs-heading-anchor-permalink" href="#State-network" title="Permalink"></a></h2><p>Next, similar to the senator case, we plot eigenvectors of the inflated dynamic Laplacian corresponding to the state network.</p><pre><code class="language-julia hljs">h_state = plot(partition_state); plot(h_state[1][1:4]...)</code></pre><p><img src="../figs/evecs_state.svg" alt/></p><p>Clearly the first spatial eigenvector is the second one (note that this is a multiplex network as opposed to the senator case). Thus we use the second eigenvector for spectral partitioning. We reorder the state vertices as well, by the magnitude of the eigenvector at the last time step.</p><pre><code class="language-julia hljs">evec_crit_state = reshape(partition_state.evecs[:,2],partition_state.graph.N, partition_state.graph.T)
v_state = sortperm(evec_crit_state[:,end])</code></pre><h2 id="Comparing-results-from-the-senator-and-state-network"><a class="docs-heading-anchor" href="#Comparing-results-from-the-senator-and-state-network">Comparing results from the senator and state network</a><a id="Comparing-results-from-the-senator-and-state-network-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-results-from-the-senator-and-state-network" title="Permalink"></a></h2><p>So how do these two networks compare? The state network is an aggregate of voting similarities of different senators belonging to the same state. For each state, we have two senators per congress (two years, one time step). </p><p>Thus we compute the projection of the third eigenvector of the senator network onto the state network. This is done by finding the two senators corresponding to each state per time step, and assigning them the value obtained from the senator network eigenvector.</p><pre><code class="language-julia hljs">evecs_temp = [reshape(partition.evecs[:,3], mlgraph.N, mlgraph.T),]
sens_ = find_active(mlgraph) 
state_proj = [zeros(2*length(lab_statelist[v_state]), partition.graph.T) for i in 1:length(evecs_temp)]
for i in 1:length(state_proj)
    for x in 1:length(lab_statelist[v_state]), y in 1:size(state_proj[i])[2]
        ind_ = findall(z-&gt;(z ∈ sens_[y] &amp;&amp; lab_state[z] == lab_statelist[v_state][x]), 1:partition.graph.N)
        if length(ind_)==1
            state_proj[i][(x-1)*2+1,y] = evecs_temp[i][ind_[1],y]
        else
            state_proj[i][(x-1)*2+1:2*x,y] = evecs_temp[i][ind_[1:2], y]
            # None of this accounts for states that may have more than two senators in a single congress (with incomplete terms)
        end
    end
end
# Filter
for i in 1:length(state_proj)
    for (j,x) in enumerate(state_proj[i])
        if x == 0.0
            state_proj[i][j] = NaN
        end
    end
end
state_proj

state_proj[1] .*= sqrt(200);
partition_state.evecs .*= sqrt(200);</code></pre><p><code>state_proj</code> contains the projection of senator results on to the network of states. We finally plot the results,</p><pre><code class="language-julia hljs">labelss = vcat([[x; &quot;&quot;] for x in lab_statelist[v_state]]...);

h1 = heatmap(reshape(-partition_state.evecs[:,2],mlgraph_state.N,mlgraph_state.T)[v_state,:], c=cgrad(:RdBu), size=(600,800), yticks=(1:50,lab_statelist[v_state]), xticks=(1:2:11,1987:4:2009), dpi=300, clims = (-1,1))

h2 = heatmap(state_proj[1], c=cgrad(:RdBu), size=(600,800), yticks=(1:100,labelss), xticks=(1:2:11,1987:4:2009), dpi=300, grid=false, clims=(-1,1))

hline!(h2,0.5:2.0:(101+0.5), c=:black, labels=&quot;&quot;, lw=1)

plot(h1, h2, size=(900,700))</code></pre><p><img src="../figs/projection.svg" alt/></p><p>The state and senator networks show a &quot;fading-in&quot; of polarisation as time passes. Note that the red-blue split is exactly along party lines.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../NonMultiplex/">« Nonmultiplex temporal networks</a><a class="docs-footer-nextpage" href="../conts/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Wednesday 21 August 2024 11:26">Wednesday 21 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
